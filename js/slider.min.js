var sliderClass=function(a,b){var c=$(a),d=c.find(".jslider-item");console.log(c);var e=d.length,f=$.extend({},$.fn.jslider.defaults,b),g={},h=function(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a]},k=h(),l=function(a){d.eq(a.current_index).addClass("current"),d.eq(a.prev_index).addClass("prev"),d.eq(a.next_index).addClass("next")},m=function(a){d.eq(a.current_index).removeClass("current"),d.eq(a.prev_index).removeClass("prev"),d.eq(a.next_index).removeClass("next")},n=function(a){a.animating_state?console.log("already animation is running"):g[a.effect](a)},o=function(a){a.current_index=(a.current_index+1)%e,a.prev_index=(a.prev_index+1)%e,a.next_index=(a.next_index+1)%e},p=function(a){a.current_index=(a.current_index+e-1)%e,a.prev_index=(a.prev_index+e-1)%e,a.next_index=(a.next_index+e-1)%e};g.fade=function(a){a.animating_state=!0,"prev"==a.direction&&(console.log("updating index"),p(a)),"next"==a.direction&&(console.log("updating index"),o(a)),l(a),d.eq(a.prev_index).hide(),d.eq(a.next_index).hide(),d.eq(a.current_index).fadeIn(a.duration,function(){a.animating_state=!1})},g.disperse=function(a){for(x_center=f.row/2+1,y_center=f.column/2+1,i=1;i<=f.row;i++)for(j=1;j<=f.column;j++)key=i+""+j,i<x_center&&j<y_center&&(a[key].x_target=a[key].x-Math.abs(i-x_center)*f.offset,a[key].y_target=a[key].y-Math.abs(j-y_center)*f.offset),i<x_center&&j>y_center&&(a[key].x_target=a[key].x+Math.abs(i-x_center)*f.offset,a[key].y_target=a[key].y-Math.abs(j-y_center)*f.offset),i>x_center&&j<y_center&&(a[key].x_target=a[key].x-Math.abs(i-x_center)*f.offset,a[key].y_target=a[key].y+Math.abs(j-y_center)*f.offset),i>x_center&&j>y_center&&(a[key].x_target=a[key].x+Math.abs(i-x_center)*f.offset,a[key].y_target=a[key].y+Math.abs(j-y_center)*f.offset)},g.split=function(a){$prev_item=d.eq(f.prev_index),$current_item=d.eq(f.current_index),part_width=f.width/f.column,part_height=f.height/f.row,prev_item_parts_object={};for(var b=0;b<f.row;b++)for(var c=0;c<f.column;c++){var e={};e.y=b*part_height,e.x=c*part_width,e.matrix_code=b+1+""+(c+1);var h=e.matrix_code;prev_item_parts_object[h]=e}g.disperse(prev_item_parts_object),img_src=$prev_item.find("img").attr("src"),$prev_item.empty(),Object.keys(prev_item_parts_object).forEach(function(a,b){var c=document.createElement("div");c.className="part",c.style.cssText="background:url('"+img_src+"'); top:"+prev_item_parts_object[a].y+"px; left:"+prev_item_parts_object[a].x+"px;",c.style.backgroundPosition=prev_item_parts_object[a].x+"px "+prev_item_parts_object[a].y+"px",c.style.width=part_width+"px",c.style.height=part_height+"px",c.id="j-"+prev_item_parts_object[a].matrix_code,console.dir(c),$prev_item.append(c)}),Object.keys(prev_item_parts_object).forEach(function(a,b){$("#j-"+prev_item_parts_object[a].matrix_code).animate({top:prev_item_parts_object[a].y_target,left:prev_item_parts_object[a].x_target},f.duration)})},g.hang=function(){};var q=function(a){d.eq(a.current_index).show(),d.eq(a.prev_index).hide(),d.eq(a.next_index).hide()};g.book_fold=function(a){console.log("entering book fold"),a.animating_state=!0;for(var b=a.effect+"-",e=d.eq(a.prev_index),f=d.eq(a.current_index),g=d.eq(a.next_index),h=a.width/2,i=a.height,j=[],m=[],n=0;n<2;n++){var r={};r.x=n*h,r.y=0*i,m.push(r),j.push(r)}"next"==a.direction&&($original_item=f,$new_item=g),"prev"==a.direction&&($original_item=f,$new_item=e);var s=$original_item.find("img").attr("src");$original_item.empty(),m.forEach(function(a,c){var d=document.createElement("div");d.className=b+"old-part ",d.className+="old-part-no-"+c,d.style.cssText="background:url('"+s+"'); top:"+a.y+"px; left:"+a.x+"px;",d.style.backgroundPosition=a.x+"px "+a.y+"px",d.style.width=h+"px",d.style.height=i+"px",$original_item.append(d)});var t=$new_item.find("img").attr("src");j.forEach(function(a,c){var d=document.createElement("div");d.className=b+"new-part ",d.className+="new-part-no-"+c,d.style.cssText="background:url('"+t+"'); top:"+a.y+"px; left:"+a.x+"px;",d.style.backgroundPosition=a.x+"px "+a.y+"px",d.style.width=h+"px",d.style.height=i+"px",0==c?d.classList.add(b+"new-part-page1-ani-before"):d.classList.add(b+"new-part-page2-ani-before"),$original_item.append(d)}),setTimeout(function(){$(".old-part-no-0",c).addClass(b+"old-part-page1-ani-after"),$(".old-part-no-1",c).addClass(b+"old-part-page2-ani-after"),$(".new-part-no-0",c).addClass(b+"new-part-page1-ani-after"),$(".new-part-no-1",c).addClass(b+"new-part-page2-ani-after"),console.log("doing animation");var d=0;$original_item.one(k,function(b){++d,$(this).empty(),$(this).append("<img src='"+s+"' alt='' />"),$new_item.empty(),$new_item.append("<img src='"+t+"' alt='' />"),console.log("animation over"+d),a.animating_state=!1,"prev"==a.direction&&(console.log("updating index"),p(a),q(a),l(a)),"next"==a.direction&&(console.log("updating index"),o(a),q(a),l(a))})},300)};var r=function(a,b){a.animating_state||(m(a),a.direction="prev",n(a))},s=function(a){a.animating_state||(m(a),a.direction="next",n(a))};l(f),d.each(function(a){a==f.current_index?$(this).show():$(this).hide()}),$("a.arrow-left",c).on("click",function(a){a.preventDefault(),r(f)}),$("a.arrow-right",c).on("click",function(a){a.preventDefault(),s(f)}),f.automatic&&(f.automatic_ID=setInterval(function(){s(f)},5e3)),c.on({mouseenter:function(){f.automatic&&clearInterval(f.automatic_ID)},mouseleave:function(){f.automatic&&(f.automatic_ID=setInterval(function(){s()},5e3))}},".current")};$.fn.jslider=function(a){return this.each(function(b,c){sliderClass(c,a)})},$.fn.jslider.defaults={animating_state:!1,automatic:!1,effect:"fade",direction:"",duration:500,responsive:!1,current_index:1,prev_index:0,next_index:2,width:600,height:450,offset:10,row:5,column:5};